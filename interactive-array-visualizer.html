<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dark Mode Custom Color Interactive Array Visualizer with Customizable Indexes</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-color: #1a1a1a;
            color: #e0e0e0;
        }

        #array-container {
            background-color: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
        }

        .control-section {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .section-title {
            width: 100%;
            font-weight: bold;
            margin-bottom: 5px;
            color: #b0b0b0;
        }

        button, input {
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
        }

        button:hover {
            background-color: #45a049;
        }

        input[type="text"], input[type="number"] {
            background-color: #3a3a3a;
            color: #e0e0e0;
            border: 1px solid #5a5a5a;
        }

        input[type="color"] {
            width: 50px;
            height: 30px;
            padding: 0;
            border: none;
        }

        .color-picker {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .color-picker label {
            font-size: 14px;
            min-width: 70px;
        }

        #show-indexes {
            margin-right: 10px;
        }
        .font-size-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .font-size-control label {
            min-width: 120px;
        }
    </style>
</head>
<body>
<div id="array-container">
    <svg width="600" height="150"></svg>
</div>
<div class="controls">
    <div class="control-section">
        <div class="section-title">Array Input</div>
        <label for="array-input"></label><input type="text" id="array-input"
                                                placeholder="Enter array (comma-separated)">
        <button onclick="updateArray()">Update Array</button>
    </div>
    <div class="control-section">
        <div class="section-title">Array Operations</div>
        <label for="split-index"></label><input type="number" id="split-index" placeholder="Split index" min="0">
        <button onclick="splitArray()">Split Array</button>
        <button onclick="resetArray()">Reset</button>
    </div>
    <div class="control-section">
        <div class="section-title">Color Settings</div>
        <div class="color-picker">
            <label for="base-color">Base:</label>
            <input type="color" id="base-color" value="#E3F9F9" onchange="updateColors()">
        </div>
        <div class="color-picker">
            <label for="highlight-color">Highlight:</label>
            <input type="color" id="highlight-color" value="#1AD1B2" onchange="updateColors()">
        </div>
        <div class="color-picker">
            <label for="split1-color">Split 1:</label>
            <input type="color" id="split1-color" value="#1AD1B2" onchange="updateColors()">
        </div>
        <div class="color-picker">
            <label for="split2-color">Split 2:</label>
            <input type="color" id="split2-color" value="#91C0BF" onchange="updateColors()">
        </div>
    </div>
    <div class="control-section">
        <div class="section-title">Visual Settings</div>
        <div class="font-size-control">
            <label for="element-font-size">Element Font Size:</label>
            <input type="number" id="element-font-size" value="18" min="8" max="24" onchange="changeFontSize()">
        </div>
        <div class="font-size-control">
            <label for="index-font-size">Index Font Size:</label>
            <input type="number" id="index-font-size" value="14" min="8" max="24" onchange="changeFontSize()">
        </div>
        <input type="checkbox" id="show-indexes" checked onchange="drawArray()">
        <label for="show-indexes">Show Indexes</label>
    </div>
    <div class="control-section">
        <div class="section-title">Export</div>
        <button onclick="downloadImage()">Download Image</button>
    </div>
</div>

<script>
    let arr = [1, 1, 1, 2, 3, 4];
    const width = 600;
    const height = 150;
    let elementWidth = width / arr.length;

    const svg = d3.select("svg");

    let colors = {
        base: "#E3F9F9",
        highlight: "#1AD1B2",
        split1: "#1AD1B2",
        split2: "#91C0BF"
    };

    function drawArray() {
        svg.selectAll("*").remove();

        elementWidth = width / arr.length;

        const elements = svg.selectAll("g")
            .data(arr)
            .enter()
            .append("g")
            .attr("transform", (d, i) => `translate(${i * elementWidth}, 0)`);

        elements.append("rect")
            .attr("class", "array-element")
            .attr("width", elementWidth - 2)
            .attr("height", height - 52)
            .attr("fill", colors.base)
            .on("click", function () {
                const currentColor = d3.select(this).attr("fill");
                d3.select(this).attr("fill",
                    currentColor === colors.highlight ? colors.base : colors.highlight
                );
            });

        elements.append("text")
            .attr("class", "array-text")
            .attr("x", elementWidth / 2)
            .attr("y", (height - 52) / 2)
            .attr("text-anchor", "middle")
            .attr("dominant-baseline", "middle")
            .text(d => d)
            .attr("fill", "#1a1a1a");

        if (document.getElementById("show-indexes").checked) {
            elements.append("text")
                .attr("class", "index-text")
                .attr("x", elementWidth / 2)
                .attr("y", height - 35)
                .attr("text-anchor", "middle")
                .attr("dominant-baseline", "middle")
                .text((d, i) => i)
                .attr("fill", "#e0e0e0");
        }

        changeFontSize();
    }

    function updateArray() {
        const input = document.getElementById("array-input").value;
        arr = input.split(",").map(item => parseInt(item.trim()));
        drawArray();
    }

    function splitArray() {
        const splitIndex = parseInt(document.getElementById("split-index").value);
        if (isNaN(splitIndex) || splitIndex < 0 || splitIndex >= arr.length) {
            alert("Please enter a valid split index");
            return;
        }
        svg.selectAll("rect")
            .attr("fill", (d, i) => i < splitIndex ? colors.split1 : colors.split2);
    }

    function resetArray() {
        svg.selectAll("rect")
            .attr("fill", colors.base);
    }

    function updateColors() {
        colors.base = document.getElementById("base-color").value;
        colors.highlight = document.getElementById("highlight-color").value;
        colors.split1 = document.getElementById("split1-color").value;
        colors.split2 = document.getElementById("split2-color").value;
        resetArray();
    }

    function changeFontSize() {
            const elementFontSize = document.getElementById("element-font-size").value;
            const indexFontSize = document.getElementById("index-font-size").value;
            svg.selectAll(".array-text")
                .style("font-size", `${elementFontSize}px`);
            svg.selectAll(".index-text")
                .style("font-size", `${indexFontSize}px`);
        }

    function downloadImage() {
        const svgNode = svg.node();
        const svgWidth = svgNode.width.baseVal.value;
        const svgHeight = svgNode.height.baseVal.value;

        const canvas = document.createElement("canvas");
        canvas.width = svgWidth;
        canvas.height = svgHeight;
        const ctx = canvas.getContext("2d");

        const img = new Image();
        const svgData = new XMLSerializer().serializeToString(svgNode);
        const svgBlob = new Blob([svgData], {type: "image/svg+xml;charset=utf-8"});
        const url = URL.createObjectURL(svgBlob);

        img.onload = function () {
            ctx.drawImage(img, 0, 0);
            URL.revokeObjectURL(url);

            const pngUrl = canvas.toDataURL("image/png");
            const downloadLink = document.createElement("a");
            downloadLink.href = pngUrl;
            downloadLink.download = "array_visualization.png";
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
        };
        img.src = url;
    }

    drawArray();
</script>
</body>
</html>
